<!doctype html>
<html>
<head>
    <title>Exercise 9 - Chloropleth Map</title>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width">
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
               integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
               crossorigin=""/>
        <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
                integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
                crossorigin=""></script>
    
    <style>
        #map {height: 600px;
              width: 800px; }
    </style>
 
</head>
    <body>
        <div id='map'>
        <div class="leaflet-control-container">
                <div class="leaflet-top leaflet-right">
                    <div class="leaflet-control-layers leaflet-control" aria-haspopup="true"==$0>
                        <a class="leaflet-control-layers-toggle", href="#" title="Layers">
                        </a>
                        <section class="leaflet-control-layers-list">
                        </section>
                    </div>
                </div>
            </div>
        </div>
        
        <script src="https://cjmurray1.github.io/CRP558/geojson/obesityqgis.geojson"></script>
        
         <script src="https://cjmurray1.github.io/CRP558/geojson/illinois.geojson"></script>
        
        <script type="text/javascript">
            
              var streets = L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}',
                        {id: 'mapbox/streets-v11',
                         tileSize: 512,
                         zoomOffset: -1,
                         attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
                         accessToken: 'pk.eyJ1IjoiY2ptdXJyYXkiLCJhIjoiY2s3MjJ2ZmRmMGJ2MTNobndmZjJvcDlrcSJ9.jB-YBe7p4TnYVigxWxGvpw'}),
                    satellite   = L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', 
                        {id: 'mapbox/satellite-v9', 
                         tileSize: 512,
                         zoomOffset: -1, 
                         attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
                        accessToken: 'pk.eyJ1IjoiY2ptdXJyYXkiLCJhIjoiY2s3MjJ2ZmRmMGJ2MTNobndmZjJvcDlrcSJ9.jB-YBe7p4TnYVigxWxGvpw'
                        });
                var baseMaps = {
                    "Satellite": satellite,
                    "Streets": streets
                    };
            
            var map = L.map('map', {
                center:[39.711685, -88.976099],
                zoom: 7,
                layers: [streets,satellite]
            
            });
            
            var baseLayers = {
                "Satellite": satellite,
                "Streets": streets
            };
            
            var overlayMaps = {
                "County Obesity Rate": obesity,
                "State boundary": illinois
            };
            
            L.control.layers(baseLayers, overlayMaps).addTo(map);
            
            L.geoJson(illinois).addTo(map);
            
            function getColor(d) {
                return d > 32  ? '#2c7fb8' :
                        d > 30 ? '#41b6c4' :
                        d > 28 ? '#7fcdbb' :
                        d > 26 ? '#c7e9b4' :
                                        '#fffcc';
            }
            
            function style(feature) {
            return {
                weight: 1,
                opacity: 1,
                color:'white',
                fillColor: getColor(feature.properties.Percent_1)
            };
        }
        
            L.geoJson(obesity, {style: style}).addTo(map);
            
            
        function highlightFeature(County) {
            var layer = County.target;
            
            layer.setStyle({
                weight: 2,
                color: 'black',
                dashArray: '',
                fillOpacity: 0.8
            
            });
            
            if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                layer.bringToFront();
            }
        }
            
            var geojson;
            
            function resetHighlight(County) {
                geojson.resetStyle(County.target);
            }
            
            function zoomToFeature(County) {
                map.fitBounds(County.target.getBounds());
            }
            
            function onEachFeature(feature, layer) {
                layer.on({
                    mouseover: highlightFeature,
                    mouseout: resetHighlight,
                    click: zoomToFeature
                });
            }
            
            geojson = L.geoJson(obesity, {
                style: style,
                onEachFeature: onEachFeature
            }).addTo(map);
            
            
            
        </script>
        
    </body>
    
</html>
